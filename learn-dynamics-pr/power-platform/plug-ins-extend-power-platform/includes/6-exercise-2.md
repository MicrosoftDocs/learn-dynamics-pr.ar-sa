---
ms.openlocfilehash: eea34b3402c51a52074457d7592a9367dd3acfed2c6da2d5c8ff4ffb5a30a35e
ms.sourcegitcommit: 511a76b204f93d23cf9f7a70059525f79170f6bb
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 08/11/2021
ms.locfileid: "7457291"
---
بشكل متكرر، يلزم إجراء تنسيق التاريخ على بيانات Microsoft Dataverse. بينما يعرض Power Automate بعض الميزات حول هذه العملية، فقد يكون من المناسب أحيانًا إنتاج ملحقات سير عمل مخصصة لتحقيق هذا الهدف (على سبيل المثال، إذا كان المنطق يحتاج إلى التشغيل بشكل متزامن داخل بيئتك).

## <a name="exercise-1-create-a-custom-activity"></a>التمرين 1: إنشاء نشاط مخصص 

ستنشئ في هذا التمرين نشاطًا مخصصًا من شأنه تحويل التاريخ والوقت إلى التوقيت المحلي للمستخدم، وتنسيقه كـالتالي: "الاثنين، 25 ديسمبر 2019"، ونشر القيمة المنسقة كسلسلة إلى مستهلك النشاط المخصص.

يتألف كل تمرين من سيناريو وأهداف تعليمية. يصف السيناريو الغرض من التمارين، بينما يتم سرد الأهداف وتحتوي على نقاط.

### <a name="task-1-create-a-custom-activity"></a>المهمة 1: إنشاء نشاط مخصص

1.  قم بتشغيل Visual Studio 2019.

2.  حدد **ملف > جديد > مشروع**.

3.  حدد **مكتبة الفئة (NET Framework.)** ثم حدد **التالي**.

    > ![قم بإنشاء مربع حوار مشروع جديد باستخدام قالب مشروع مكتبة الفئة (Net Framework.) المحدد.](../media/class-library-net-framework.png)

4.  أدخل **WorkflowActivities** في حقل **اسم المشروع**، وحدد **.NET Framework 4.6.2** في القائمة المنسدلة **إطار العمل**، ثم حدد **إنشاء**.

    > ![يمكنك تكوين مربع حوار مشروع جديد باستخدام المشروع "WorkflowActivities".](../media/create-workflow-activities.png)

5.  انقر بزر الماوس الأيمن على **Class1.cs** ثم حدد **حذف**.

    > ![يعرض مستكشف الحلول Class1.cs الذي تم النقر عليه بزر الماوس الأيمن ويتم تمييز خيار الحذف.](../media/delete-2.png)

6.  انقر بزر الماوس الأيمن على المشروع وحدد **إدارة حزم NuGet**.

    > ![يعرض مستكشف الحلول المشروع WorkflowActivities الذي تم النقر عليه بزر الماوس الأيمن ويتم تمييز الخيار إدارة حزم NuGet.](../media/manage-nuget-packages-2.png)

7.  حدد علامة التبويب **استعراض**، وابحث عن **Microsoft.CRMSDK.CoreAssemblies** وحددها، ثم حدد **تثبيت**.

    > ![يعرض مدير الحزم NuGet تجميع Microsoft.CRMSDK.CoreAssemblies مع تحديد علامة اختيار بواسطة Microsoft (على عكس نفس الملف بواسطة مؤلفين آخرين) ومع تمييز زر التثبيت.](../media/microsoft-crmsdk-coreassemblies.png)

8.  حدد **أوافق** إذا وافقت على البنود.

9.  ابحث عن **Microsoft.CRMSDK.Workflow** وحدده ثم حدد **تثبيت**.

    > ![يعرض مدير الحزم NuGet تجميع Microsoft.CRMSDK.Workflow.](../media/microsoft-crmsdk-workflow.png)

10. حدد **أوافق** إذا وافقت على البنود.

11. انقر بزر الماوس الأيمن على المشروع، وحدد **إضافة**، ثم حدد **الفئة**.

    > ![يعرض مستكشف الحلول المشروع WorkflowActivities الذي تم النقر عليه بزر الماوس الأيمن والخيار "إضافة" عند التمرير عليه وخيار "الفئة" الذي تم تمييزه.](../media/class.png)

12. أدخل **ConvertFormatDatetime** في حقل **الاسم** ثم حدد **إضافة**.

    > ![أضف مربع حوار عنصر جديد مع تحديد فئة Visual C# وتعيين الاسم إلى ConvertFormatDatetime.](../media/convert-form-a-date-time.png)

13. قم بإضافة عبارات الاستخدام إلى الفئة كما يلي ثم اجعلها عامة.

    ```c#
    using Microsoft.Crm.Sdk.Messages;
    
    using Microsoft.Xrm.Sdk;
    
    using Microsoft.Xrm.Sdk.Query;
    
    using Microsoft.Xrm.Sdk.Workflow;
    
    using System.Activities;
    ```

    > ![تُظهر القصاصة البرمجية عبارات الاستخدام ومساحة اسم WorkflowActivities مع تمييز "عام" في الفئة العامة ConvertFormatDatetime.](../media/statements.png)

14. استورد من **CodeActivity** ونفِّذ العضو التجريدي.
    سيمنع هذا الإجراء الأسلوب Execute للفئة الموروثة.

    > ![يتم تمييز Intellisense في ConvertFormatDatetime مع خيار تنفيذ الفئة المجردة.](../media/codeactivity.png)

15. أضف القصاصة البرمجية التالي إلى الفئة. سيؤدي ذلك إلى إضافة وسيطة إدخال مطلوبة من النوع DateTime ووسيطة إخراج من النوع String.

    ```
    [RequiredArgument]
    
    [Input("DateTime input")]
    
    public InArgument<DateTime> DateToEvaluate { get; set; }
    
    [Output("Formatted DateTime output as string")]
    
    public OutArgument<String> ForammtedDateTimeOutput { get; set; }
    ```

    > ![قصاصة برمجية مع وسائط الإدخال المتصلة بالفئة.](../media/snippet-6.png)

16. استبدل NotImplementedException بالقصاصة البرمجية التالية.
 
    ```c#
    IWorkflowContext workflowContext =
    context.GetExtension<IWorkflowContext>();
    
    IOrganizationServiceFactory serviceFactory =
    context.GetExtension<IOrganizationServiceFactory>();
    
    IOrganizationService service =
    serviceFactory.CreateOrganizationService(workflowContext.UserId);
    ```

    > ![تُظهر القصاصة البرمجية الأسلوب Execute مع رمز السياق المتصل به.](../media/snippet-7.png)

17. احصل على تاريخ ووقت الإدخال. أضف القصاصة البرمجية التالية إلى الأسلوب Execute.

    ```c#
    DateTime utcDateTime = this.DateToEvaluate.Get(context);
    ```

18. تحقق مما إذا كان تاريخ ووقت الإدخال هو **UTC**، إذا لم يكن كذلك، فقم بتحويله إلى **UTC**. أضف القصاصة البرمجية التالية إلى الأسلوب Execute.

    ```c#
    if (utcDateTime.Kind != DateTimeKind.Utc)
    
    {
    
        utcDateTime = utcDateTime.ToUniversalTime();
    
    }
    ```

    يجب أن يبدو الأسلوب Execute الخاص بك للتنفيذ الآن مثل الصورة التالية.

    > ![تُظهر القصاصة البرمجية الأسلوب Execute المكتمل.](../media/execute-method-example.png)

### <a name="task-2-get-user-settings-and-convert-datetime-to-user-local-datetime&quot;></a>المهمة 2: الحصول على إعدادات المستخدم وتحويل التاريخ والوقت إلى التاريخ والوقت المحلي للمستخدم

1.  احصل على TimeZoneCode للمستخدم لكيان إعدادات المستخدم. أضف القصاصة البرمجية التالية إلى الأسلوب Execute.

    ```c#
    var settings = service.Retrieve(&quot;usersettings&quot;,
    workflowContext.UserId, new ColumnSet(&quot;timezonecode") );
    ```

    > ![تُظهر القصاصة البرمجية محتويات الأسلوب Execute مع تمييز سطر التعليمات البرمجية المُضاف حديثًا.](../media/snippet-8.png)

2.  قم بإنشاء طلب تغيير المنطقة الزمنية عن طريق توفير الوقت **Utc** الذي حصلت عليه من الإدخال و **TimeZoneCode** من إعدادات المستخدم.

    ```c#
    LocalTimeFromUtcTimeRequest timeZoneChangeRequest = new
    LocalTimeFromUtcTimeRequest()
    
    {
    
    UtcTime = utcDateTime,
    
    TimeZoneCode = int.Parse(settings["timezonecode"].ToString())
    
    };
    ```

    > ![تُظهر القصاصة البرمجية التعليمات البرمجية المضافة حديثًا أسفل إعلان متغير الإعدادات.](../media/snippet-9.png)

3.  قم بتشغيل طلب تغيير المنطقة الزمنية.

    ```c#
    LocalTimeFromUtcTimeResponse timeZoneResponse =
    service.Execute(timeZoneChangeRequest) as LocalTimeFromUtcTimeResponse;
    ```

4.  قم بتنسيق **LocalTime** من استجابة المنطقة الزمنية وتعيينها إلى إخراج النشاط.

    ```c#
    this.ForammtedDateTimeOutput.Set(context, String.Format("{0:f}",
    timeZoneResponse.LocalTime));
    ```

    من المفترض أن تبدو فئتك الآن مثل الصورة التالية.

    > ![تُظهر القصاصة البرمجية الفئة المكتملة.](../media/class-example-3.png)

6.  انقر بزر الماوس الأيمن على المشروع وحدد **خصائص**.

    > ![يتم تمييز مشروع "WorkflowActivities" الذي تم النقر عليه بزر الماوس الأيمن مع خيار الخصائص.](../media/properties-2.png)

7.  حدد علامة التبويب **التوقيع** وحدد خانة الاختيار **التوقيع على التجميع**، وحدد **جديد** في القائمة المنسدلة **اختر ملف مفتاح اسم قوي**.

    > ![يتم تمييز علامة تبويب التوقيع في مربع حوار الخصائص مع تحديد توقيع التجميع وضمن اختيار ملف مفتاح اسم قوي، مع الخيار جديد.](../media/signing-new.png)

8.  أدخل **contoso.snk** في حقل **اسم ملف المفتاح**، وامسح خانة الاختيار **حماية ملف مفتاحي بكلمة مرور**، ثم حدد **موافق**.

    > ![مربع حوار ملف مفتاح جديد مع contoso.snk الذي تم إدخاله كاسم ملف مفتاح.](../media/contoso-snk-ok.png)

9.  قم ببناء المشروع وتأكد من نجاح البناء.

## <a name="exercise-2-register-and-consume"></a>تمرين 2: تسجيل واستهلاك 

ستقوم في هذا التمرين بتسجيل نشاط سير العمل، وإنشاء حل وإعداده، وإنشاء سير عمل، ثم اختبار سير العمل والنشاط المخصص.

### <a name="task-1-register-the-workflow-activity"></a>المهمة 1: تسجيل نشاط سير العمل

1. انتقل إلى مجلد Dynamics 365 SDK الخاص بك وافتح المجلد **PluginRegistration**.

2. انقر نقرًا مزدوجًا على **PluginRegistration.exe**.

    > ![يتم تمييز "مستكشف الملفات" مع التطبيق "PluginRegistration.exe".](../media/plugin-registration-2.png)

3. حدد **إنشاء اتصال جديد**.

    > ![يتم تمييز أداة تسجيل المكون الإضافي مع الزر "إنشاء اتصال جديد".](../media/create-new-connection-2.png)

4. حدد **Microsoft 365**، وقدم بيانات اعتمادك، ثم حدد **تسجيل الدخول**.

5. حدد **تسجيل** ثم حدد **تسجيل تجميع جديد**.

    > ![يتم تمييز أداة تسجيل المكون الإضافي مع عنصر التسجيل المُحدد وخيار تسجيل التجمع الجديد.](../media/register-new-assembly.png)

6. حدد **استعراض**.

    > ![قم بتسجيل مربع حوار التجميع الجديد بالزر علامة الحذف بجوار "الخطوة 1: تحديد موقع التجميع المراد تحليله" الذي تم تمييزه.](../media/browse-3.png)

7. استعرض للوصول إلى مجلد تصحيح الأخطاء لمشروعك **WorkflowActivities**، وحدد **WorkflowActivities.dll**، ثم حدد **فتح**.

    > ![يتم تمييز مربع حوار فتح الملف مع تجميع "WorkflowActivities.dll" والزر "فتح".](../media/open-workflowactivities-dll.png)

8. حدد **تسجيل المكونات الإضافية المُحددة**.

    > ![يتم تمييز مربع حوار "تسجيل تجمع جديد" مع سير العمل المُضاف والزر "تسجيل المكونات الإضافية المُحددة".](../media/register-selected-plugin.png)

9. حدد **موافق**.

    > ![يُظهر مربع رسالة الإضافات المسجلة تجميعًا واحدًا مسجلًا ومكوِّنًا إضافيًا مسجلًا، مع تمييز الزر "موافق".](../media/ok-3.png)

### <a name="task-2-create-and-prepare-a-solution"></a>المهمة 2: إنشاء حل وإعداده

1.  انتقل إلى [https://make.powerapps.com](https://make.powerapps.com/?azure-portal=true) وتأكد من عدم تحديد البيئة الافتراضية.

2.  حدد **الحلول** ثم حدد **حل جديد**.

    > ![تفتح صفحة Power Apps with Solutions ويتم تمييز الزر "حل جديد".](../media/new-solution.png)

3.  أدخل **Contoso WFA** في الحقل **‏‫اسم العرض**، وأدخل **ContosoWFA** في حقل **الاسم**، ثم حدد القائمة المنسدلة **الناشر**.

    > ![يتم تمييز مربع حوار الحل الجديد مع القائمة المنسدلة "الناشر".](../media/publisher-dropdown.png)

4.  حدد **+ الناشر**.

    > ![يتم تحديد القائمة المنسدلة "الناشر" مع الخيار "إضافة الناشر".](../media/add-publisher.png)

5.  أدخل **Contoso** في الحقل **‏‫اسم العرض**، وأدخل **contoso** في حقل **البادئة**، ثم حدد **حفظ وإغلاق**.

    > ![يتم تمييز مربع حوار ناشر جديد مع Contoso كاسم العرض والبادئة مع الزر حفظ وإغلاق.](../media/save-close.png)

6.  حدد القائمة المنسدلة **الناشر** مرة أخرى وحدد الناشر الذي قمت بإنشائه.

    > ![يتم تمييز القائمة المنسدلة "الناشر" مع الخيار "Contoso".](../media/select-publisher.png)

7.  أدخل **1.0.0.0** في حقل **الإصدار** ثم حدد **إنشاء**.

    > ![يتم تمييز تعيين حقل الإصدار على 1.0.0.0 مع الزر "إنشاء".](../media/create.png)

8.  افتح الحل الذي قمت بإنشائه.

    > ![يتم تمييز قائمة الحلول مع Contoso WFA.](../media/open-solution.png)

9.  حدد **إضافة موجود**، ثم حدد **كيان**.

    > ![يتم تمييز القائمة المنسدلة حل مع إضافة موجود مع كيان.](../media/add-existing-entity.png)

10. ستستخدم الكيان **مهمة** لنص نشاط سير العمل. حدد **مهمة**، ثم حدد **التالي**.

    > ![يتم تحديد معالج إضافة كيانات موجودة مع كيان المهمة.](../media/task-entity.png)

11. حدد الخيار **تحديد المكونات**.

    > ![يُظهر معالج إضافة كيانات حالية "ستتم إضافة كيان واحد إلى مشروعك" مع تمييز إجراء تحديد المكونات.](../media/select-components.png)

12. حدد علامة التبويب **نماذج**، ثم حدد النموذج **مهمة**، ثم حدد **إضافة**.

    > ![يتم تحديد علامة التبويب "النماذج" مع نموذج المهمة.](../media/add-task.png)

13. حدد **إضافة** مرة أخرى.

    > ![تُظهر الكيانات المحددة رسالة "ستتم إضافة كيان واحد إلى مشروعك" وإدراج نموذج المهمة وإجراء تحديد المكونات، ومسح مربع الاختيار "تضمين كل المكونات"، وزر "إضافة".](../media/add-entity.png)

14. حدد لفتح كيان **المهمة** الذي قمت توا بإضافته إلى حلك.

    > ![يتم تمييز قائمة الحلول > Contoso WFA مع كيان المهمة.](../media/open-task.png)

15. حدد علامة التبويب **الحقول** ثم حدد **+ إضافة حقل**.

    > ![تفتح حلول > Contoso WFA > صفحة المهمة على علامة التبويب "الحقول" مع تمييز الزر إضافة حقل.](../media/add-field.png)

16. أدخل **التاريخ والوقت المنسق** في حقل **اسم العرض**، حدد **نص** من القائمة المنسدلة **نوع البيانات**، ثم حدد **تم**.

    > ![مربع حوار التاريخ والوقت المنسق مع تعيين الاسم على التاريخ والوقت المنسق، وتعيين نوع البيانات إلى نص، وتحديد مربع النص القابل للبحث.](../media/formatted-datetime.png)

17. حدد الزر **حفظ كيان**.

    > ![يفتح حلول > Contoso WFA > صفحه المهمة على علامة التبويب "الحقول" مع التاريخ والوقت المنسق بالخط العريض في القائمة والزر حفظ الكيان في أسفل اليمين.](../media/save-entity.png)

18. حدد علامة التبويب **نماذج**، ثم حدد لفتح نموذج **المهمة**.

    > ![تفتح حلول > Contoso WFA > صفحة المهمة على علامة التبويب "النماذج" مع تمييز الزر إضافة نموذج المهمة.](../media/task-form.png)

19. اسحب حقل **الوقت والتاريخ المنسق** إلى النموذج ثم قم بوضعه أسفل حقل **الموضوع**.

    > ![يُظهر نموذج مهمة جديد التاريخ والوقت المنسق الذي يتم سحبه من قائمة الحقول إلى حقل الموضوع.](../media/drag-formatted-datetime.png)

20. حدد **حفظ**.

    > ![لقطة شاشة صغيرة لزر "حفظ" مع سهم يشير إليها.](../media/save.png)

21. حدد **نشر** وانتظر حتى اكتمال النشر.

22. أغلق علامة تبويب أو نافذة متصفح محرر النماذج.

23. حدد **تم**.

    > ![تقوم حاليًا بتحرير رسالة نموذج تنص على "عند الانتهاء من تحرير النموذج، انقر على "تم" أدناه للعودة إلى الكيان. سيؤدي ذلك إلى تحديث الصفحة وجلب التغييرات التي أجريتها.](../media/done.png)

### <a name="task-3-create-a-workflow"></a>المهمة 3: إنشاء سير العمل

1.  حدد **حلول** وافتح الحل الذي قمت بإنشائه.

    > ![يتم تمييز قائمة الحلول مع حل Contoso WFA.](../media/open-solution-2.png)

2.  حدد الزر علامة الحذف (**...**) وحدد **التبديل إلى الكلاسيكي**.

    > ![يتم تمييز علامة الحذف التي تم النقر عليها مع الخيار التبديل إلى الكلاسيكي.](../media/switch-to-classic.png)

3.  حدد **العملية** ثم حدد **جديد**.

    > ![يتم تمييز طريقة عرض الشجرة لمكونات حل Contoso WFA مع عقدة العمليات المحددة والزر "جديد".](../media/process-new.png)

4.  أدخل **تحويل وتنسيق التاريخ والوقت** في حقل **اسم العملية**، وحدد **سير العمل** من القائمة المنسدلة **الفئة**، وحدد **المهمة** من القائمة المنسدلة **الكيان**، وامسح خانة الاختيار **تشغيل سير العمل هذا في الخلفية (مستحسن)**، ثم حدد **موافق**.

    > ![يتم تمييز مربع حوار "إنشاء عملية" مع الزر "موافق".](../media/create-process-ok.png)

5.  حدد خانة الاختيار **كعملية حسب الطلب** وحدد **المؤسسة** من القائمة المنسدلة **النطاق**.

    > ![يتم تمييز مربع الحوار مع متاح للتشغيل "كعملية حسب الطلب" وضمن "خيارات العمليات التلقائية"، مع تحديد "النطاق" إلى "المؤسسة".](../media/organization-scope.png)

6.  حدد **إضافة خطوة** ثم حدد **‏‫التحقق من الشرط**.

    > ![يتم تمييز القائمة المنسدلة "إضافة خطوة" مع خيار "التحقق من الشرط".](../media/check-condition.png)

7.  أدخل **تحقق ما إذا كان تاريخ الاستحقاق يحتوي على قيمة** كوصف ثم حدد **تكوين**.

    > ![يتم تمييز وصف التحقق من الشرط مع إجراء أدناه مفاده "إذا كان الشرط (انقر للتكوين)، ثم: حدد هذا الصف، وانقر على "إضافة خطوة."](../media/click-to-configure.png)

8.  قم بتعيين الشرط كما هو موضح في الصورة التالية ثم حدد **حفظ وإغلاق**.

    > ![تُظهر علامة التبويب "ملف" الزر "حفظ وإغلاق".](../media/save-and-close.png)

9.  حدد أدناه عبارة الشرط.

    > ![ضمن خطوة "التحقق ما إذا كان تاريخ الاستحقاق يحتوي على قيمة"، أسفل الشرط "إذا كانت المهمة:تاريخ الاستحقاق يحتوي على بيانات، عندئذ:"، يتم تمييز "حدد هذا الصف وانقر على "إضافة خطوة".](../media/condition.png)

10. حدد **إضافة خطوة** ثم حدد **نشاط سير العمل المخصص** الذي قمت بإنشائه.

    > ![يتم تمييز القائمة المنسدلة إضافة خطوة مع WorkflowActivities (1.0.0.0) ويتم تمييز النشاط WorkflowActivities.ConvertFormatDatetime.](../media/custom-workflow-activity.png)

11. قم بتوفير وصف ثم حدد **تعيين الخصائص**.

    > ![ضمن خطوة "التحقق ما إذا كان تاريخ الاستحقاق يحتوي على قيمة، إذا كانت المهمة: تاريخ الاستحقاق يحتوي على بيانات، عندئذ: يتم تمييز الزر "تنسيق الوقت والتاريخ يحتوي على تعيين الخصائص".](../media/set-properties.png)

12. حدد حقل **القيمة**، ثم حدد **تاريخ الاستحقاق**، ثم حدد **إضافة**.

    > ![في الصفحة "تعيين خصائص إدخال الخطوة المخصصة"، يتم تمييز حقل "تحتوي خاصية إدخال التاريخ والوقت على القيمة"، ويتم تمييز الحقول "مساعد النموذج يحتوي على البحث عن: المهمة وتاريخ الاستحقاق"، وسهم يشير إلى الزر "إضافة".](../media/due-date-add.png)

13. حدد **موافق**.

    > ![تاريخ استحقاق (المهمة) مع سهم يشير إلى الزر "موافق".](../media/ok-4.png)

14. حدد **حفظ وإغلاق**.

    > ![يُظهر "تعيين خصائص إدخال خطوة مخصصة" حقل القيمة الخاص بخاصية إدخال التاريخ والوقت معينًا إلى {Due Date(Task)} ويتم تمييز الزر "حفظ وإغلاق".](../media/save-and-close-2.png)
15. حدد الخطوة التي قمت بإضافتها، ثم حدد **إضافة خطوة**، ثم حدد **تحديث السجل**.

    > ![يتم تمييز القائمة المنسدلة "إضافة خطورة" مع تحديث السجل.](../media/update-record.png)

16. قم بتوفير وصفًا، وتأكد من تحديد **المهمة** للكيان في القائمة المنسدلة **تحديث**، ثم حدد **تعيين الخصائص**.

    > ![أسفل الوصف "تحديث حقل التاريخ والوقت المنسق"، يتم تعيين التحديث إلى مهمة، ويتم تمييز الزر "تعيين الخصائص".](../media/set-properties-2.png)

17. حدد الحقل **التاريخ والوقت المنسق**، وحدد **تنسيق التاريخ والوقت** من القائمة المنسدلة **البحث عن**، ثم حدد **إضافة**.

    > ![في مربع حوار "تحديث المهمة"، يتم تمييز الحقل الفارغ "التاريخ والوقت المنسق"، وفي مساعد النموذج، يتم تمييز خيارات البحث عن تنسيق التاريخ والوقت وإخراج التاريخ والوقت المنسق كسلسلة بسهم يشير إلى الزر "إضافة".](../media/update-task-add.png)

18. حدد **موافق**.

    > ![إخراج التاريخ والوقت المنسق كسلسلة في القائمة مع سهم يشير إلى الزر "موافق".](../media/ok-5.png)

19. حدد **حفظ وإغلاق**.

    > ![يتم تعيين مربع حوار "تحديث المهمة" مع الحقل "التاريخ والوقت المنسق" إلى {Formatted DateTime output as string(Format Datetime)}، مع تمييز الزر "حفظ وإغلاق".](../media/save-and-close-3.png)

20. حدد الخطوة التي قمت بإضافتها، ثم حدد **إضافة خطوة**، ثم حدد **إيقاف سير العمل**.

    > ![يتم تمييز القائمة المنسدلة "إضافة خطوة" مع خيار "إيقاف سير العمل".](../media/stop-workflow.png)

21. حدد خطوة الشرط، وحدد **إضافة خطوة**، ثم حدد **الإجراء الافتراضي**.

    > ![يتم تمييز القائمة المنسدلة "إضافة خطوة" مع خيار ‎‏‎"الإجراء الافتراضي".](../media/default-action.png)

22. حدد أسفل **خلاف ذلك**، ثم حدد **إضافة خطوة**، ثم حدد **إيقاف سير العمل**.

    > ![مرة أخرى، يتم تمييز القائمة المنسدلة "إضافة خطوة" مع خيار "إيقاف سير العمل".](../media/stop-workflow-2.png)

23. يجب أن يبدو سير عملك الآن مثل الصورة التالية. حدد **حفظ**.

    > ![يتم اكمال سير العمل بالكامل بالإضافة إلى جميع الخطوات ويتم تمييز الزر "حفظ وإغلاق".](../media/save-2.png)

24. حدد **تنشيط**.

25. تأكيد التنشيط.

26. حدد **إغلاق**.

    > ![يتم تمييز الحافة العليا للنموذج مع الزر "إغلاق".](../media/close.png)

27. حدد **نشر كل التخصيصات** وانتظر حتى يكتمل النشر.

    > ![يتم تمييز الحافة العليا للنموذج مع الزر "نشر كل التخصيصات".](../media/publish-all-customizations.png)

28. أغلق النافذة **مستكشف الحلول**.

### <a name="task-4-test-the-workflow-and-custom-activity"></a>المهمة 4: اختبار سير العمل والنشاط المخصص

1.  انتقل إلى [https://make.powerapps.com](https://make.powerapps.com/?azure-portal=true) وتأكد من أنك لست في البيئة الافتراضية.

2.  حدد **التطبيقات** وحدد لفتح تطبيق **مركز CRM**.

    > ![يتم فتح صفحة تطبيق مركز CRM مع التطبيقات وتمييز تطبيق مركز CRM.](../media/crm-hub-2.png)

3.  حدد **الأنشطة**، ثم حدد **المهمة**.

    > ![يتم فتح صفحة تطبيق مركز CRM مع الأنشطة وتمييز زر "المهمة".](../media/activities-task.png)

4.  أدخل **اختبار المهمة** لـ **الموضوع**، وحدد تاريخ ووقت **الاستحقاق**، ثم حدد **حفظ**.

    > ![يتم تمييز مربع حوار "مهمة جديدة" مع تاريخ ووقت الاستحقاق وسهم يشير إلى الزر "حفظ".](../media/due-date-time.png)

5.  يجب تشغيل نشاط سير العمل المخصص وتعبئة الحقل **التاريخ والوقت المنسق**. يجب أن تكون قيمتا تاريخ **الاستحقاق** و **التاريخ والوقت المنسق** متطابقتين.

    > ![يتم تمييز قيم "اختبار المهمة" مع "تاريخ ووقت الاستحقاق" و"التاريخ والوقت المنسق".](../media/formatted-datetime-2.png)

6.  حدد **الإعدادات** ثم حدد **إعدادات التخصيص**.

    > ![يتم تمييز القائمة المنسدلة "الإعدادات" مع خيار "إعدادات التخصيص".](../media/personalization-settings.png)

7.  قم بتغيير **المنطقة الزمنية** إلى منطقة أخرى ثم حدد **موافق**.

    > ![يتم تمييز علامة التبويب "عام" لمربع حوار "الإعدادات" مع المنطقة الزمنية.](../media/timezone.png)

8.  يجب إعادة تحميل المهمة. يجب أن تتغير قيمة الحقل **تاريخ الاستحقاق** إلى المنطقة الزمنية المحددة تلقائيًا، ولكن يجب ألا تتغير قيمة **التاريخ والوقت المنسق**.

    > ![يُظهر اختبار المهمة مع تاريخ ووقت الاستحقاق 11 صباحًا ويُظهر التاريخ والوقت المنسق 1 مساءً.](../media/task-reload.png)

9.  حدد **سير العمل** ثم حدد سير العمل الذي قمت بإنشائه.

    > ![يتم تمييز القائمة المنسدلة "سير العمل" مع "تحويل وتنسيق وقت وتاريخ سير العمل" ضمن "تشغيل سير العمل".](../media/select-workflow.png)

10. حدد **موافق**.

    > ![يُظهر مربع رسالة "تأكيد تطبيق سير العمل" الرسالة "سيتم تطبيق سير العمل هذا على مهمة واحدة". يمكن مراقبة مهام سير العمل من خلال فتح كل مهمة والنقر على مهام سير العمل. ‏‫هل تريد المتابعة بالفعل؟‬](../media/confirm-application-ok.png)

11. حدد **تحديث**.

    > ![يتم تمييز "اختبار المهمة مع الزر "تحديث".](../media/refresh.png)

    يجب أن تكون قيمتا تاريخ **الاستحقاق** و **التاريخ والوقت المنسق** متطابقتين.

    > ![يُظهر "اختبار المهمة" مع تاريخ ووقت الاستحقاق 11 صباحًا ويُظهر التاريخ والوقت المنسق 11 صباحًا.](../media/due-date-formatted-datetime-same.png)
 
