---
ms.openlocfilehash: 81bb85948eb0ed4bc369aac56879e8cd0736fc0a
ms.sourcegitcommit: 8773c31cceaa4d9a36c62c964a2b414c6e0656f3
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 08/13/2021
ms.locfileid: "7457561"
---
تحتاج المؤسسة في هذا السيناريو إلى التأكد من إدخال بيانات رقم الهاتف بتنسيقٍ متسق. وتحقيقاً لذلك الهدف، يتعين إنشاء مكون إضافي لتشغيل الإنشاء/التحديث الذي يعمل على إزالة جميع الأحرف غير الرقمية من رقم الهاتف قبل الحفظ إلى Common Data Service. وبعد ذلك، يتعين إنشاء مكون إضافي آخر والذي سيتم تشغيله على رسائل Retrieve وRetrieveMultiple‬ في "جهة الاتصال" لإعادة تنسيق رقم الهاتف ليتضمن الأقواس والشُرط، وذلك في حالة وجود البيانات. 

## <a name="exercise-1-createupdate-plug-in"></a>التمرين الأول: إنشاء/تحديث المكون الإضافي 

ستنشئ في ذلك التمرين مكوناً إضافياً والذي يتم تشغيله عند الإنشاء والتحديث. وسيعمل هذا المكون الإضافي على إزالة الأحرف غير الرقمية من رقم الهاتف.

يتألف كل تمرين من سيناريو وأهداف تعليمية. يصف السيناريو الغرض من التمارين، بينما يتم سرد الأهداف وتحتوي على نقاط.

> [!NOTE]
> وفي حال عدم توفر أدوات Dynamics 365 SDK، راجع [تنزيل الأدوات من NuGet](/dynamics365/customerengagement/on-premises/developer/download-tools-nuget) لتنزيلها.

### <a name="task-1-create-a-plug-in"></a>المهمة الأولى: إنشاء مكون إضافي

1.  قم بتشغيل Visual Studio 2019.

2.  حدد **ملف > جديد > مشروع**.

3.  حدد **مكتبة الفئات (NET Framework.)** وحدد **التالي**.

    > ![أنشئ مربع حوار مشروع جديد يظهر قوالب المشروع الأخيرة التي قامت الفئة C# بتصفيتها مع تحديد قالب مشروع مكتبة الفئات (.NET Framework).](../media/class-library.png)

4.  أدخل عبارة **D365PackageProject** لـ **اسم المشروع**، وحدد موقعًا لحفظ المشروع، وحدد **.NET Framework 4.6.2** لـ **إطار العمل**، ثم حدد **إنشاء**.

    > ![اعمل على تكوين مربع حوار مشروع جديد يظهر اسم "المشروع" و"الموقع" و"الحل" و"إطار العمل".](../media/configure-new-project.png)

5.  انقر بزر الماوس الأيمن على المشروع وحدد **إدارة حزم NuGet**.

    > ![جرى النقر بزر الماوس الأيمن فوق اسم المشروع وجرى تظليل "إدارة حزم NuGet".](../media/manage-nuget-packages.png)

6.  حدد علامة التبويب **استعراض**، وابحث عن **microsoft.crmsdk.coreassemblies** وحددها، ثم حدد **تثبيت**.

    > ![تعرض علامة التبويب "استعراض" نتائج microsoft.crmsdk.coreassemblies مع تظليل علامة الاختيار "بواسطة Microsoft" (على عكس نفس الملف بواسطة مؤلفين آخرين) ومع تظليل زر "تثبيت".](../media/install.png)

7.  اقرأ شروط الترخيص ثم حدد **قبول** عند موافقتك.

8.  أغلق مدير حزم NuGet.

9.  انقر بزر الماوس الأيمن فوق **Class1.cs** و **حذف**.

    > ![جرى النقر بزر الماوس الأيمن فوق Class1.cs مع تظليل استخدام خيار "حذف".](../media/delete.png)

10. انقر بزر الماوس الأيمن فوق المشروع، ثم حدد **إضافة > فئة**.

11. ابدأ تسمية الفئة الجديدة **PreOperationFormatPhoneCreateUpdate** وحدد **إضافة**.

    > ![جرى تحديد مربع حوار فئة جديدة باستخدام فئة C# المرئية مع تعيين الاسم إلى PreOperationFormatPhoneCreateUpdate.](../media/pre-operation-format-phone-create-update.png)

12. أضف عبارات الاستخدام إلى الفئة الجديدة كما يلي:

    ```c#
    using Microsoft.Xrm.Sdk;
    
    using System.Text.RegularExpressions;
    ```

13. جعل الفئة عامة وتنفيذ واجهة **IPlugin**.

    > ![ابدأ تفعيل التعليمة البرمجية لواجهة IPlugin وتظليل التعليمة البرمجية "public class PreOperationFormatPhoneCreateUpdate : IPlugin".](../media/iplugin.png)

14. ابدأ تنفيذ عضو الواجهة.

    > ![ابدأ عمل تحسس ذكي على IPlugin مع تظليل خيار واجهة "تنفيذ"، ولا يؤدي الخطأ CS0535 'PreOperationContactCreateUpdate' إلى تنفيذ ظهور عضو الواجهة 'IPlugin.Execute(IServiceProvider)'.](../media/implement-interface.png)

    من المفترض أن تبدو فئتك الآن مثل الصورة التالية.

    > ![جزء تعليمة برمجية متكررة باستخدام مساحة الاسم D365PackageProject وجعل فئة PreOperationFormatPhoneCreateUpdate عامة باستخدام IPlugin والأسلوب Execute (IServiceProvider serviceProvider) التي تلقي NotImplementedException جديداً.](../media/class-example.png)

### <a name="task-2-format-a-phone-number"></a>المهمة الثانية: تنسيق رقم الهاتف

1.  احصل على سياق التنفيذ من موفر الخدمة. استبدل الاستثناء الموجود في الأسلوب Execute بجزء التعليمة البرمجية المتكررة التالي.

    ```c#
    IPluginExecutionContext context =
    (IPluginExecutionContext)serviceProvider.GetService(typeof(IPluginExecutionContext));
    ```

    > ![تفعيل جزء التعليمة البرمجية المتكررة باستخدام public class PreOperationFormatPhoneCreateUpdate مع IPlugin والأسلوب Execute (IServiceProvider serviceProvider) مع توصيل التعليمة البرمجية الجديدة بها.](../media/snippet.png)

2.  تحقق من صحة معلمة إدخال الهدف. أضف القصاصة البرمجية التالية إلى الأسلوب Execute.

    ```c#
    if (!context.InputParameters.ContainsKey("Target"))
    
    throw new InvalidPluginExecutionException("No target found");
    ```

3.  أضف القصاصة البرمجية التالية إلى الأسلوب Execute. سيحصل جزء التعليمة البرمجية المتكررة ذلك على الكيان الهدف من معلمة الإدخال، وبعد ذلك يتم التحقق مما إذا كانت سماته تحتوي على "الهاتف الأول" ("هاتف العمل الخاص بجهات الاتصال" و"الهاتف الخاص بالحسابات") من عدمه.

    ```c#
    var entity = context.InputParameters["Target"] as Entity;
    
    if (!entity.Attributes.Contains("telephone1"))
    
    return;
    ```

4.  أضف جزء التعليمة البرمجية المتكررة التالي إلى الدالة Execute. سيزيل جزء التعليمة البرمجية المتكررة هذا جميع الأحرف غير الرقمية من رقم الهاتف الذي قدمه المستخدم.

    ```c#
    string phoneNumber = (string)entity["telephone1"];
    
    var formattedNumber = Regex.Replace(phoneNumber, @"[^\d]", "");
    ```

5.  ابدأ تعيين "الهاتف الأول" إلى رقم هاتف منسق. أضف القصاصة البرمجية التالية إلى الأسلوب Execute.

    ```c#
    entity["telephone1"] = formattedNumber;
    ```
    سيبدو الأسلوب Execute الآن مثل الصورة التالية.

      > ![الأسلوب Execute (IServiceProvider serviceProvider) مع توصيل جميع التعليمات البرمجية الجديدة بها.](../media/execute-method.png)

7.  انقر بزر الماوس الأيمن على المشروع وحدد **خصائص**.

    > ![تعرض تظليل النقر بزر الماوس الأيمن فوق المشروع وخيار "الخصائص".](../media/properties.png)

8.  حدد علامة تبويب **التوقيع** وحدد **ملف مفتاح جديد**.

    > ![تعرض علامة تبويب "التوقيع" مع تحديد "توقيع التجميع" وتظليل خيار "جديد" ضمن "اختيار ملف مفتاح اسم قوي".](../media/new-key-file.png)

9.  أدخل **contoso.snk** في حقل **اسم ملف المفتاح**، وامسح خانة الاختيار **حماية ملف مفتاحي بكلمة مرور**، ثم حدد **موافق**.

    > ![أنشئ مربع حوار "مفتاح اسم قوي" يظهر اسم ملف "المفتاح" المعين إلى contoso.snk مع إلغاء تحديد خانة الاختيار "حماية ملف المفتاح بكلمة مرور".](../media/contoso-snk.png)

10. أغلق علامة التبويب **الخصائص**.

11. قم ببناء المشروع وتأكد من نجاح البناء.

### <a name="task-3-register-a-plug-in-and-steps"></a>المهمة الثالثة: تسجيل مكون إضافي والخطوات

> [!NOTE]
> وفي حال عدم توفر أدوات Dynamics 365 SDK، راجع [تنزيل الأدوات من NuGet](/dynamics365/customerengagement/on-premises/developer/download-tools-nuget) لتنزيلها.

1.  ابدأ تشغيل أداة تسجيل المكونات الإضافية الموجودة في مجلد Dynamics 365 SDK.

    > ![يتم تمييز "مستكشف الملفات" مع التطبيق "PluginRegistration.exe".](../media/plugin-registration.png)

2.  حدد **إنشاء اتصال جديد**.

    > ![يتم تمييز أداة تسجيل المكون الإضافي مع الزر "إنشاء اتصال جديد".](../media/new-connection.png)

3.  حدد **Microsoft 365**، وحدد خانة الاختيار **‬‏‫إظهار الخيارات المتقدمة**، وابدأ توفير بيانات اعتمادك، ثم حدد **تسجيل الدخول**.

    > ![جرى تعيين مربع حوار "تسجيل الدخول" بـ "نوع التوزيع" إلى Office 365، مع تحديد "إظهار الخيارات المتقدمة" وملء خانة "‏‫المنطقة المتوفرة على الإنترنت‬" وإدخال "اسم المستخدم" و"كلمة المرور".](../media/login.png)

4.  حدد **تسجيل** ثم حدد **تسجيل تجميع جديد**.

    > ![جرى تحديد تسجيل القائمة المنسدلة مع تظليل خيار "تسجيل تجميع جديد".](../media/new-assembly.png)

5.  حدد **استعراض**.

    > ![جرى تظليل مربع حوار "تسجيل تجميع جديد" الذي يحتوي على زر علامة الحذف بجوار "الخطوة الأولى: حدد موقع التجميع المراد تحليله".](../media/browse.png)

6.  استعرض لتصل إلى مجلد **الحاوية > تصحيح الأخطاء** في مكتبة الفئات التي أنشأتها، وحدد **D365PackageProject**، ثم حدد **فتح**.

    > ![جرى تحديد مربع حوار D365PackageProject.dll وتظليل زر "فتح".](../media/open.png)

7.  حدد **تسجيل المكونات الإضافية المُحددة**.

    > ![جرى تحديد مربع حوار "تسجيل تجميع جديد" باستخدام التجميع والمكون الإضافي، وتعيين وضع العزل إلى "بيئة الاختبار المعزولة"، وتعيين الموقع إلى قاعدة البيانات، وتظليل زر "تسجيل المكونات الإضافية المُحددة".](../media/register-selected-plugins.png)

8.  حدد **موافق**.

    > ![يظهر مربع رسالة "المكونات الإضافية المسجلة" عبارة "تم تسجيل المكونات الإضافية المُحددة". "تسجيل 1 تجميع"، و"تجاهل 0 تجميع"، و"تحديث 0 تجميع"، و"تسجيل 1 مكون إضافي"، و"تجاهل 0 مكون إضافي"، "مواجهة 0 مكون إضافي أخطاء"، و"إزالة 0 مكون إضافي".](../media/ok.png)

9.  ابدأ توسيع التجميع المسجل حديثاً.

    > ![جرى تظليل قائمة التجميعات باستخدام (تجميع) D365PackageProject.](../media/assembly.png)

10. انقر بزر الماوس الأيمن فوق المكون الإضافي وحدد **تسجيل خطوة جديدة**.

    > ![توسيع عقدة (تجميع) D365PackageProject لعرض المكون الإضافي، والذي جرى النقر فوقه بزر الماوس الأيمن مع تظليل خيار "تسجيل خطوة جديدة"](../media/register-new-step.png)

11. حدد **إنشاء** لـ **الرسالة** وحدد **جهة اتصال** لـ **الكيان الأساسي**.

    > ![يظهر مربع حوار "تسجيل خطوة جديدة" "معلومات التكوين العامة" مع تحديد جهة الاتصال باعتبارها الكيان الأساسي.](../media/contact-primary-entity.png)

12. حدد **PreOperation** لـ **مرحلة تنفيذ ‏‫البنية الأساسية لبرنامج ربط العمليات التجارية للحدث‬** ثم حدد **تسجيل خطوة جديدة**.

    > ![يظهر مربع حوار "تسجيل خطوة جديدة" تظليل PreOperation أسفل "مرحلة تنفيذ ‏‫البنية الأساسية لبرنامج ربط العمليات التجارية للحدث"، وتظليل الزر "تسجيل خطوة جديدة".](../media/preoperation.png)

13. انقر بزر الماوس الأيمن فوق المكون الإضافي وحدد **تسجيل خطوة جديدة** مرةً أخرى.

    > ![جرى النقر بزر الماوس الأيمن فوق المكون الإضافي مع تظليل خيار "تسجيل خطوة جديدة".](../media/register-new-step-2.png)

14. حدد **تحديث** لـ **الرسالة**، وحدد **جهة الاتصال** لـ **الكيان الأساسي**، ثم حدد البحث في **السمات**.

    > ![جرى تظليل مربع حوار "تسجيل خطوة جديدة" الذي يحتوي على زر علامة الحذف بجوار خاصية "تصفية السمات‬".‬](../media/attributes-lookup.png)

15. ابدأ إلغاء تحديد خانة الاختيار **تحديد الكل**، وحدد خانة الاختيار **هاتف العمل**، ثم حدد **موافق**.

    > ![حدد مربع حوار "السمات" مع إلغاء تحديد "تحديد الكل" وتحديد "هاتف العمل" وتظليل الزر "موافق".](../media/select-attributes.png)

16. حدد **PreOperation** لـ **مرحلة تنفيذ ‏‫البنية الأساسية لبرنامج ربط العمليات التجارية للحدث‬** ثم حدد **تسجيل خطوة جديدة**.

    > ![أسفل "مرحلة تنفيذ ‏‫البنية الأساسية لبرنامج ربط العمليات التجارية للحدث"، تم تحديد PreOperation وتظليلها.](../media/event-pipeline-stage-execution.png)

### <a name="task-4-test-a-plug-in"></a>المهمة الرابعة: اختبار مكون إضافي

1.  انتقل إلى مجلد **Dynamics 365** وقم بالتبديل إلى تطبيق **مركز CRM‬**.

    > ![جرى تظليل علامة تبويب الصفحة الرئيسية لـ Dynamics 365 وتطبيق مركز CRM.](../media/crm-hub.png)

2.  حدد **جهات الاتصال** ثم حدد **+ جديد**.

    > ![جرى تظليل صفحة "جهات الاتصال النشطة" والزر "جديد".](../media/new-contacts.png)

3.  أدخل **اختبار** لـ **الاسم الأول** و **جهة اتصال** لـ **اسم العائلة** و **(123)-555-0100** لـ **هاتف العمل**، ثم حدد **حفظ**.

    > ![جرى تظليل مربع حوار "جهة اتصال جديدة" وزر "حفظ" و"هاتف العمل".](../media/save-contact.png)

    يجب حفظ السجل، ويجب أن يظهر **هاتف العمل** القيم الرقمية فقط.

    > ![جرى تظليل علامة تبويب "الملخص" لـ "جهة اتصال الاختبار" و"هاتف العمل".](../media/business-phone.png)

5.  ابدأ تغيير **هاتف العمل** إلى **001-123-555-0100** وانتظر بضع ثوانٍ.

    > ![جرى تظليل علامة تبويب "الملخص" لـ "جهة اتصال الاختبار" وتحديث قيم "هاتف العمل" بالشُرط.](../media/update-business-phone.png)

    يجب تحديث السجل، ويجب أن يظهر **هاتف العمل** القيم الرقمية فقط.

    > ![جرى تظليل علامة تبويب "الملخص" لـ "جهة اتصال الاختبار" وتحديث قيمة "هاتف العمل" بالقيم الرقمية فقط.](../media/numeric-values.png)

## <a name="exercise-2-createretrieve-multiple-plug-ins"></a>التمرين الثاني: إنشاء/استرداد مكونات إضافية متعددة 

ستنشئ في ذلك التمرين مكوناً إضافياً والذي يتم تشغيله عند الاسترداد والاسترداد المتعدد. سيضيف هذا المكون الإضافي الأقواس والشُرط إلى أرقام الهواتف.

يتألف كل تمرين من سيناريو وأهداف تعليمية. يصف السيناريو الغرض من التمارين، بينما يتم سرد الأهداف وتحتوي على نقاط.

### <a name="task-1-create-a-plug-in"></a>المهمة الأولى: إنشاء مكون إضافي

1.  ابدأ تشغيل Visual Studio.

2.  افتح المشروع الذي أنشأته في التمرين الأول.

3.  انقر بزر الماوس الأيمن فوق مشروع وحدد **إضافة > فئة**.

    > ![جرى النقر بزر الماوس الأيمن فوق ملف المشروع في "مستكشف الحلول" وتحديد "إضافة" وتظليل "فئة".](../media/add-class.png)

4.  في حقل **الاسم** أدخل **PostOperationFormatPhoneOnRetrieveMultiple** للفئة ثم حدد **إضافة**.

    > ![أضف مربع حوار "فئة" مع تعيين اسم إلى PostOperationFormatPhoneOnRetrieveMultiple.](../media/post-operation-format-phone-on-retrieve-multiple.png)

5.  أضف عبارات الاستخدام إلى الفئة الجديدة كما يلي:

    ```c#
    using Microsoft.Xrm.Sdk;
    ```

6.  جعل الفئة عامة وتنفيذ واجهة **IPlugin**.

    > ![يظهر كعب روتين تعليمات برمجية للفئة العامة مع تنفيذ واجهة IPlugin.](../media/iplugin-2.png)

7.  ابدأ تنفيذ عضو الواجهة.

    > ![ابدأ عمل تحسس ذكي على خطأ واجهة IPlugin الذي يتيح لك تنفيذ الواجهة.](../media/implement-interface-2.png)

    من المفترض أن تبدو فئتك الآن مثل الصورة التالية.

    > ![يُظهر الفئة بالأسلوب Execute التي تأخذ واجهة IServiceProvider.](../media/class-example-2.png)

### <a name="task-2-format-phone-number-for-retrieve"></a>المهمة الثانية: تنسيق رقم الهاتف للاسترداد

1.  احصل على سياق التنفيذ من موفر الخدمة. استبدل الاستثناء الموجود في الأسلوب Execute بجزء التعليمة البرمجية المتكررة التالي.

    ```c#
    IPluginExecutionContext context =
    (IPluginExecutionContext)serviceProvider.GetService(typeof(IPluginExecutionContext));
    ```

    > ![جزء تعليمة برمجية متكررة يُظهر الأسلوب Execute مع توصيل التعليمة البرمجية لسياق التنفيذ.](../media/snippet-2.png)

2.  تحقق من ترميز الاسم بـ Retrieve أو RetrieveMultiple. أضف القصاصة البرمجية التالية إلى الأسلوب Execute.

    ```c#
    if (context.MessageName.Equals("Retrieve"))
    
    {
    
    }
    
    else if(context.MessageName.Equals("RetrieveMultiple"))
    
    {
    
    }
    ```

3.  تحقق مما إذا كانت معلمات الإخراج تحتوي على كيان أعمال وأنه نوع كيان من عدمه. ألصق جزء التعليمة البرمجية المتكررة التالي داخل الشرط `if` retrieve.

    ```c#
    if (!(context.OutputParameters.Contains("BusinessEntity") && context.OutputParameters["BusinessEntity"] is Entity)
    throw new InvalidPluginExecutionException("No business entity found"));
    ```

4.  احصل على الكيان وتحقق مما إذا كان يحتوي على الحقل telephone1 من عدمه. أضف جزء التعليمة البرمجية المتكررة التالي داخل الشرط `if` retrieve.

    ```c#
    var entity = (Entity)context.OutputParameters["BusinessEntity"]
    
    if (!entity.Attributes.Contains("telephone1"))
    
    return;
    ```

5.  أضف جزء التعليمة البرمجية المتكررة التالي إلى الشرط `if retrieve`. سيحاول جزء التعليمة البرمجية المتكررة هذا تحليل telephone1 بشكلٍ *طويل* وسيتم إرجاعه إذا لم تنجح عملية التحليل.

    ```
    if (!long.TryParse(entity["telephone1"].ToString(), out long
    phoneNumber))
    
    return;
    ```

    > ![جزء التعليمة البرمجية المتكررة للأسلوب Execute مع تمييز الشرط TryParse داخل الشرط Retrieve.](../media/snippet-3.png)

6.  ابدأ تنسيق رقم الهاتف بإضافة الأقواس والشُرط. أضف جزء التعليمة البرمجية المتكررة التالي داخل الشرط `if retrieve`.

    ```
    var formattedNumber = String.Format("{0:(###) ###-####}",
    phoneNumber);
    
    entity["telephone1"] = formattedNumber;
    ```

    سيبدو جزء استرداد الأسلوب Execute الآن مثل الصورة التالية.

    > ![جزء التعليمة البرمجية المتكررة للأسلوب Execute يُظهر جزء Retrieve بتنسيق رقم الهاتف.](../media/retrieve-part.png)

### <a name="task-3-format-phone-number-for-retrieve-multiple&quot;></a>المهمة الثالثة: تنسيق رقم الهاتف للاسترداد المتعدد

1.  أضف جزء التعليمة البرمجية المتكررة التالي إلى داخل شرط `retrieve multiple`.
    سيتحقق جزء التعليمة البرمجية المتكررة هذا مما إذا كانت معلمات الإخراج تحتوي على BusinessEntityCollection وإذا كانت من نوع EntityCollection.

    ```c#
    if (!(context.OutputParameters.Contains(&quot;BusinessEntityCollection") &&
    context.OutputParameters["BusinessEntityCollection"] is
    EntityCollection))
    
    throw new InvalidPluginExecutionException("No business entity
    collection found");
    ```

    > ![جزء تعليمة برمجية متكررة تُظهر الشرط RetrieveMultiple مع توصيل التعليمة البرمجية الجديدة.](../media/snippet-4.png)

2.  احصل على مجموعة الكيانات من معلمات الإخراج. أضف جزء التعليمة البرمجية المتكررة التالي داخل الشرط `retrieve multiple`.

    ```c#
    var entityCollection =
    (EntityCollection)context.OutputParameters["BusinessEntityCollection"];
    ```

3.  ابدأ التكرار من خلال كل كيان في مجموعة الكيانات.

    ```c#
    foreach (var entity in entityCollection.Entities)
    
    {
    
    }
    ```

    > ![جزء التعليمة البرمجية المتكررة يُظهر الشرط RetrieveMultiple مع تظليل حلقة foreach الفارغة.](../media/snippet-5.png)

4.  أضف جزء التعليمة البرمجية المتكررة التالي داخل الشرط `foreach`. سيفعل جزء التعليمة البرمجية المتكررة ذلك نفس الشيء الذي يفعله الشرط `retrieve`.

    ```c#
    if (!entity.Attributes.Contains("telephone1"))
    
    return;
    
    if (long.TryParse(entity["telephone1"].ToString(), out long
    phoneNumber))
    
    {
    
    var formattedNumber = String.Format("{0:(###) ###-####}",
    phoneNumber);
    
    entity["telephone1"] = formattedNumber;
    
    }
    ```

    سيبدو جزء `retrieve multiple` للأسلوب Execute الآن مثل الصورة التالية.

    > ![جزء تعليمة برمجية متكررة يُظهر الشرط RetrieveMultiple المكتمل.](../media/retrieve-multiple.png)

6.  أعد إنشاء المشروع وتأكد من نجاح الإنشاء.

### <a name="task-4-update-plug-in-assembly-and-register-steps"></a>المهمة الرابعة: تحديث تجميع مكون إضافي وخطوات التسجيل

1.  أبدا تشغيل أداة تسجيل المكونات الإضافي وحدد **إنشاء اتصال جديد**.

    > ![يتم تظليل "أداة تسجيل المكون الإضافي" مع الزر "إنشاء اتصال جديد".](../media/create-new-connection.png)

2.  حدد **Microsoft 365**، وقدم بيانات اعتمادك، ثم حدد **تسجيل الدخول**.

3.  حدد التجميع الذي سجلته في التمرين الأول ثم حدد **تحديث**.

    > ![يتم تظليل "أداة تسجيل المكون الإضافي" مع تحديد تجميع D365PackageProject وتظليل زر "تحديث".](../media/update.png)

4.  حدد **استعراض**.

    > ![جرى تظليل مربع حوار "تحديث التجميع" الذي يحتوي على زر علامة الحذف بجوار "الخطوة الأولى: حدد موقع التجميع لتحليل الاستعراض.](../media/browse-2.png)

5.  استعرض للوصول إلى مجلد تصحيح الأخطاء لمشروعك، وحدد **D365PackageProject.dll** ثم حدد **فتح**.

    > ![افتح مربع الحوار مع تحديد ملف تجميع D365PackageProject.dll.](../media/d365packageproject-dll.png)

6.  حدد المكونات الإضافية ثم حدد **تحديث المكونات الإضافية المُحددة**.

    > ![اعمل على تحديث "التجميع" مع تحديد "تحديث خصائص ومحتوى التجميع" وتحديد مكونين إضافيين، ومع تظليل زر "تحديث المكونات الإضافية المحددة".](../media/update-selected-plugins.png)

7.  حدد **موافق**.

    > ![مربع رسالة "المكونات الإضافية المسجلة" تظهر أنه تم تحديث تجميع واحد وتسجيل مكون إضافي.](../media/ok-2.png)

8.  انقر بزر الماوس الأيمن فوق المكون الإضافي الجديد وحدد **تسجيل خطوة جديدة**.

    > ![جرى النقر بزر الماوس الأيمن فوق المكون الإضافي D365PackageProject.PostOperationFormatPhoneOnRetrieveMultiple مع تظليل خيار "تسجيل خطوة جديدة".](../media/register-new-step-3.png)

9.  حدد **Retrieve** لـ **الرسالة** وحدد **جهة الاتصال** لـ **الكيان الأساسي**، ثم حدد **PostOperation** لـ **مرحلة تنفيذ ‏‫البنية الأساسية لبرنامج ربط العمليات التجارية للحدث**. تأكد من تحديد **متزامن‬** لـ **وضع التنفيذ** ثم حدد **تسجيل خطوة جديدة**.

    > ![جرى تظليل مربع حوار "تسجيل خطوة جديدة" للشرط Retrieve باستخدام "مرحلة تنفيذ ‏‫البنية الأساسية لبرنامج ربط العمليات التجارية للحدث" الخاصة بإعداد PostOperation، مع تعيين "وضع التنفيذ" إلى "متزامن".](../media/synchronous.png)

10. انقر بزر الماوس الأيمن فوق المكون الإضافي وحدد **تسجيل خطوة جديدة** مرةً أخرى.

    > ![ومجدداً، جرى النقر بزر الماوس الأيمن فوق المكون الإضافي D365PackageProject.PostOperationFormatPhoneOnRetrieveMultiple مع تظليل خيار "تسجيل خطوة جديدة".](../media/register-new-step-4.png)

11. حدد **RetrieveMultiple** لـ **الرسالة** وحدد **جهة الاتصال** لـ **الكيان الأساسي**، ثم حدد **PostOperation** لـ **مرحلة تنفيذ ‏‫البنية الأساسية لبرنامج ربط العمليات التجارية للحدث**. تأكد من تحديد **متزامن‬** لـ **وضع التنفيذ**، ثم حدد **تسجيل خطوة جديدة**.

    > ![مربع حوار "تسجيل خطوة جديدة" يظهر تعيين "الرسالة" إلى RetrieveMultiple، وجميع الإعدادات الأخرى على النحو الموضح.](../media/register-new-step-5.png)

### <a name="task-5-test-the-plug-in"></a>المهمة الخامسة: اختبار المكون الإضافي

1.  انتقل إلى تطبيق **مركز CRM** وحدد **جهات الاتصال**.

    > ![جرى تحديد تطبيق مركز CRM وجهات الاتصال.](../media/crm-hub-contacts.png)

2.  لن تتغير السجلات الموجودة التي لم تُحفظ بالتنسيق الجديد بسبب الشُرط. حدد **جديد**.

    > ![جرى تظليل صفحة "جهات اتصال مركز CRM" وزر "جديد"، بالإضافة إلى تظليل عمود "هاتف العمل" في "جهات الاتصال النشطة".](../media/contacts-new.png)

3.  اعمل على توفير المعلومات التالية ثم حدد **حفظ**.

    > ![جرى تظليل مربع حوار "جهة الاتصال الجديدة" بقيم "الاسم الأول" و"اسم العائلة" و"هاتف العمل"، إلى جانب تظليل زر "حفظ".](../media/save-contact-2.png)

    يجب حفظ السجل، كما يجب تطبيق التنسيق الجديد على المكون الإضافي.

    > ![جرى تظليل مربع حوار "جهة الاتصال الجديدة" بقيمة "هاتف العمل" لإظهار التنسيق الجديد: (123) 555-0101.](../media/record-save.png)

5.  حدد **جهات الاتصال** مرةً أخرى.

    يجب أن يظهر السجل الذي أنشأته بالتنسيق الجديد.

    > ![جرى تظليل قائمة "جهات الاتصال النشطة" بقيمة "هاتف العمل الخاص بجهة الاتصال الجديدة" لإظهار التنسيق الجديد.](../media/new-format.png)

7.  حدد إحدى جهات الاتصال الموجودة وافتحها.

    > ![جرى تظليل قائمة "جهات الاتصال النشطة" بالاسم جيم غلين‬ (نموذج) وقيمة هاتف العمل.](../media/open-existing-contact.png)

8.  ابدأ تحرير **هاتف العمل** على النحو التالي:

    > ![جرى تظليل مربع حوار "تحرير جهة الاتصال" بقيمة هاتف العمل: 123-555-0109.](../media/edit-business-phone.png)

9.  يجب حفظ السجل من خلال الحفظ التلقائي ويجب تطبيق التنسيق الجديد. حدد **جهات الاتصال** مرة أخرى.

    > ![جرى تظليل مربع حوار "تحرير جهة الاتصال" باستخدام زر "جهات الاتصال"، إلى جانب تظليل قيمة هاتف العمل لإظهار التنسيق المطبق: (123) 555-0109.](../media/click-contacts.png)

    سيحصل الهاتف الذي جرى تحريره على التنسيق الجديد.

    > ![جرى تظليل قائمة "جهات الاتصال النشطة" بقيمة "هاتف العمل الخاص بجيم غلين‬" لإظهار التنسيق الجديد.](../media/new-format-2.png)
 
