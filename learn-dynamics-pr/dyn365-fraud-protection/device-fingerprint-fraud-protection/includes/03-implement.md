---
ms.openlocfilehash: e4c431693bfad5f1107a89c8ecc9060a9cdc8038
ms.sourcegitcommit: ebad633ef39fdb38c600e65df39ec2f74e09b867
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 06/29/2022
ms.locfileid: "9063062"
---
في هذا الجزء من الوحدة النمطية، ستستخدم نموذج تطبيق التاجر للحماية من الاحتيال الذي قمت بتكوينه في وحدة [تكوين بيانات نموذج التطبيق لـ Dynamics 365 Fraud Protection](/learn/modules/configure-sample-app-fraud-protection/?azure-portal=true).  

سلسلة الخطوات التي يجب عليك اتباعها لنشر بصمات الجهاز هي:

1. تعيين رحلة العميل. 
2. تحديد مكان إجراء استدعاءات بصمات الجهاز.
3. إعداد DNS في Microsoft Azure لأخذ بصمات الجهاز.
4. إضافة استدعاءات بصمات الجهاز إلى الصفحات التي تتم مراقبتها.
5. التأكد من تلقي معلومات بصمة الإصبع بواسطة Fraud Protection.
6. التحقق من زمن الانتقال في جميع أنحاء النظام. 

## <a name="map-the-customers-journey"></a>تعيين رحلة العميل
اثنان من إمكانات Fraud Protection التي يتم استخدام بصمة الجهاز لها هما: حماية المشتريات وحماية الحساب. يتم استخدام طريقتين للتنفيذ لكليهما، اعتماداً على ما تتم حمايته:

- عندما تقوم بحماية مدخل مستند إلى ويب (التجارة الإلكترونية)، يتم إرسال بصمات جهاز Fraud Protection من خلال علامة JavaScript.
- عندما تقوم بحماية مدخل مستند إلى تطبيق الأجهزة المحمولة (التجارة الإلكترونية)، يتم إرسال استدعاءات واجهة برمجة التطبيقات إلى SDK لبصمات جهاز Fraud Protection.

يمكنك تحديد مكان نشر البصمات من خلال تطوير خريطة رحلة العميل. يجب أن تُظهر خريطة الرحلة المكان الذي سيتم فيه جمع المعلومات الهامة أثناء تفاعل العميل وتحديد متى سيتم إجراء استدعاءات API لتقييم المخاطر. 

قد تشبه خريطة رحلة العميل النموذجية، استناداً إلى نموذج التطبيق الذي قمت بتكوينه في بداية ورشة العمل هذه، الرسم التخطيطي التالي.

[ ![رسم تخطيطي لخريطة رحلة العميل مع لقطات شاشة للصفحات والمدد التي تم قضاؤها على كل صفحة.](../media/customer-journey.png)](../media/customer-journey.png#lightbox)

خذ لحظة لتطوير تجربتك من خلال رسم خريطة لرحلة عميل مألوفة لك. 

## <a name="identify-where-to-place-device-fingerprinting-calls"></a>تحديد مكان إجراء استدعاءات بصمات الجهاز 
باستخدام خريطة الرحلة من الخطوة السابقة، حدد أفضل مكان لوضع استدعاءات بصمات الجهاز. ستساعد الإرشادات التالية في تحديد أفضل موضع للاستدعاءات:

- **تحديد الصفحات التي يتم فيها اتخاذ الإجراءات الحاسمة** - على سبيل المثال، معلومات الدفع، والسداد، والاشتراك، وتسجيل الدخول، وحيث يوجد وقت إقامة معقول (> 5 ثوانٍ إن أمكن). إذا كان وقت المكوث في الصفحة المرشحة قصيراً، فحدد صفحة سابقة في تدفق المستخدم مع الأخذ في الاعتبار أن حركة المرور على الصفحة السابقة من المحتمل أن يكون لها معدل انسحاب أعلى. 

- **تنفيذ استدعاءات بصمات الجهاز قبل إجراء استدعاءات تقييم المخاطر** - يضمن إمكانية استخدام معلومات البصمات في تقييم المخاطر.

نوصي بالصفحات التالية لوضع علامات على بصمات الأصابع:

- صفحة السحب لحماية المشتريات لـ Dynamics 365 Fraud Protection.
- صفحة التسجيل أو تسجيل الدخول لحماية الحساب لـ Dynamics 365 Fraud Protection.

باستخدام خريطة الرحلة النموذجية السابقة، حدد الصفحات الأفضل لاستدعاءات بصمات الجهاز. 

استناداً إلى رحلة عميل نموذجية في التطبيق النموذجي، نوصي بوضع استدعاءات بصمات الجهاز على صفحة **تسجيل الدخول** وصفحة **معلومات الدفع**.
 
## <a name="set-up-your-dns-for-device-fingerprinting"></a>إعداد DNS لأخذ بصمات الجهاز
يمكنك اختيار أي نظام لإدارة DNS الخاص بك. توضح هذه الوحدة كيفية القيام بذلك باستخدام Azure DNS والخطوات التالية:

1. تحديد مجال فرعي ضمن مجال الجذر الخاص بك. على سبيل المثال، بالنسبة لموقع التاجر **www\.contoso\.com**، يمكنك تحديد   **f.contoso.com**. يمكنك استخدام أي بادئة. 

2. بالنسبة إلى النطاق الفرعي المحدد، أنشئ اسماً أساسياً (CNAME) يشير إلى **fpt.dfp.microsoft.com**. 

3. بالنسبة للإعداد الخلفي، قم بإنشاء شهادة طبقة مآخذ التوصيل الآمنة (SSL) للمجال الفرعي المحدد. 

4. لبدء عملية تبادل شهادات SSL، تواصل على  [DFPHelp@microsoft.com](mailto:DFPHelp@microsoft.com).

## <a name="add-device-fingerprinting-calls-to-the-monitored-pages"></a>إضافة استدعاءات بصمات الجهاز إلى الصفحات المراقبة 
هناك عدة خطوات مطلوبة لإضافة استدعاءات بصمات الجهاز إلى الصفحات المراقبة. 

1. على جانب الخادم، قم بإنشاء علامة البصمات، كما هو موضح في المثال التالي: 
    ```
    URI: https://ftp.contoso.com/mdt.js?session_id=<guid>&instance=<tenantid>&pageid=<ID>
    ``` 
    
    حيث تدعم معلمات URI القيم التالية:

    - **instanceId**
        - Azure AD ‏tenantId ‏(GUID) 
    - **pageId**    
        - “SI”: تسجيل الدخول 
        - “SU”: تسجيل الاشتراك 
        - “P”: الشراء 
        - “tst”: الاختبار 
    - **session_Id**    
        - سلسلة فريدة قابلة للتعريف بشكل عام، عادةً ما تكون GUID 
        
2. في موقع العميل، أدخل علامة البصمة كما هو موضح في المثال التالي: 
 
    ```
    <script src="https://fpt.contoso.com/mdt.js?session_id=20270d15-d27f-4a77-b94f-4df46be5c540&instanceId=80d509fb-a258-449a-9c06-a2c550a40b17&pageId=P" type="text/javascript"></script>
    ```
   
   سوف تتلقى رداً مشابهاً لاستدعاء **sample mdt.js** التالي: 

    ```
    window.dfp={url:"https://fpt.contoso.com/?session_id=211d403b-2e65-480c-a231-fd1626c2560e&CustomerId=b472dbc3-0928-4577-a589-b80090117691",sessionId:"211d403b-2e65-480c-a231-fd1626c2560e",customerId:"b472dbc3-0928-4577-a589-b80090117691",dc:"uswest"};window.dfp.doFpt=function(doc){var frm,src;true&&(frm=doc.createElement("IFRAME"),frm.id="fpt_frame",frm.style.width="1px",frm.style.height="1px",frm.style.position="absolute",frm.style.visibility="hidden",frm.style.left="10px",frm.style.bottom="0px",frm.setAttribute("style","color:#000000;float:left;visibility:hidden;position:absolute;top:-100;left:-200;border:0px"),src="https://Your_Sub_Domain/?session_id=211d403b-2e65-480c-a231-fd1626c2560e&CustomerId=b472dbc3-0928-4577-a589-b80090117691",frm.setAttribute("src",src),doc.body.appendChild(frm))};
    ```

4.  اتصل برمز البصمة بعد تحميل الصفحة بالكامل، كما هو موضح في المثال التالي:

    ```
    window.dfp.doFpt(this.document); 
    ```
 
    أرسل الحركات في [Dynamics 365 Fraud Protection ‏API](/fraud-protection-rest/api/fraud-protection-rest/?azure-portal=true)، مع المعلومات التالية:

    - في حقل **deviceContextId**، قم بتعيين معرف جلسة عمل. 
    - في حقل **deviceContextDC** في كائن deviceContext object، قم بتعيين متغير **window.dfp.dc** من استجابة mdt.js. 

> [!NOTE]
> تتوفر وحدة منفصلة حول تنفيذ API لـ Fraud Protection. ومع ذلك، لأغراض تحديد ما إذا كانت بصمة الجهاز تعمل أم لا، يتم تكوين نموذج تطبيق التاجر باستخدام استدعاءات API لـ Fraud Protection المطلوبة لتمرير معرف جلسة العمل.

لمزيد من المعلومات، راجع [إعداد بصمة الجهاز](/dynamics365/fraud-protection/device-fingerprinting/?azure-portal=true).

## <a name="confirm-that-fingerprint-information-is-being-received-by-fraud-protection"></a>التأكد من تلقي معلومات بصمة الإصبع بواسطة Fraud Protection
هناك طريقتان للتحقق مما إذا كان تنفيذ البصمات على جهازك ناجحاً: 

- عند تنفيذ عملية أخذ بصمات الجهاز على صفحة ويب، ستظهر استجابة لاستدعاء mdt.js. إذا كانت الاستجابة فارغة، فهذا مؤشر على أن معلمة واحدة على الأقل غير صالحة. حاول مرة أخرى. 

- بالنسبة للعملاء الذين يستخدمون حماية المشتريات، إذا تم تنفيذ بصمات الجهاز بشكل صحيح، فستبدأ قيم سمات جهاز المدخل في تعبئة **عُقدة DeviceContext** في مستكشف الرسوم البيانية في Fraud Protection.

**تلميحات استكشاف الأخطاء وإصلاحها** 

إذا كنت تواجه صعوبة في تحديد ما إذا كانت استدعاءات بصمات جهازك ناجحة أم لا:

- تحقق من مشكلات الشبكة التي قد تحظر الاتصال، مثل تكوين جدار الحماية. 
- تأكد من إدخال معرف جلسة جديد في كل استدعاء بصمة. 
  - عند إرسال استدعاء تقييم إلى Fraud Protection، يجب أيضاً إرسال معرّف الجلسة نفسه حتى يمكن مطابقة الاثنين. 
  - عند حدوث المطابقة، يستخدم Fraud Protection المعلومات التي يتم جمعها عن طريق أخذ بصمات الجهاز في تقييم المخاطر.  

إذا كنت لا تزال تواجه مشكلة، فاتصل بممثل Microsoft أو البريد الإلكتروني [dfphelp@microsoft.com](mailto:DFPHelp@microsoft.com).

## <a name="check-for-latency-throughout-the-system"></a>التحقق من زمن الانتقال في جميع أنحاء النظام 
يشعر معظم عملاء Fraud Protection بالقلق من أن زمن الانتقال المتزايد قد يؤثر على سرعة الحركات من طرف إلى طرف. تحقق من نظامك للتأكد من أن وقت الاستجابة الكبير لم يتم تقديمه عن غير قصد. نوصي بالتحقق من زمن الانتقال بين العوامل التالية:

- تحميل الصفحة الأولي (رطبة بالكامل) 
- طلب وسم بصمات الأصابع
- المستخدمون الذين يقومون بتحديد الزر **إرسال** أو **شراء**

نوصي أيضاً بإعادة استخدام اتصالات SSL لتجنب المزيد من زمن الانتقال.
