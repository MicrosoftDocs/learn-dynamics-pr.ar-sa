---
ms.openlocfilehash: ff32e2e799af9c001129fbdd1833bdff10d99b0f
ms.sourcegitcommit: 82ed9ded42c47064c90ab6fe717893447cd48796
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 10/19/2020
ms.locfileid: "6071551"
---
تستخدم حزمة واجهة برمجة تطبيقات (API) إطار عمل إدارة البيانات OAuth 2.0 لتفويض الوصول. لكي تتمكن من استخدام واجهة برمجة التطبيقات (API)، يجب أن تكون متصلة برمز وصول OAuth مميز صالح. بالنسبة للمؤسسات التي تقوم بنشر محلي، ستستخدم Active Directory Federation Services ‏(AD FS). 

يستخدم Azure Active Directory (Azure AD)‏ OAuth 2.0 لتمكينك من السماح بالوصول إلى تطبيقات الويب وواجهات برمجة تطبيقات الويب داخل مستأجر Azure AD. للبدء، يجب تسجيل التطبيق مع مستأجر Azure AD الخاص بك. يتم القيام بهذا من خلال [مدخل Microsoft Azure](https://ms.portal.azure.com/#home/?azure-portal=true).

فيما يلي نظرة عامة على تدفق طلب رمز مصادقة OAuth 2.0:

1. يوجه العميل المستخدم إلى `/authorize endpoint`.
2. مع هذا الطلب، يشير العميل إلى الأذونات التي يحتاج إلى الحصول عليها من المستخدم الذي يحتاج إلى الوصول. للحصول على نقطة نهاية تفويض OAuth 2.0 للمستأجر الخاص بك، يمكنك الانتقال إلى **تسجيلات التطبيقات > نقاط النهاية** في مدخل Azure.
3. في التطبيق الأصلي، يتم توجيه المستخدم لتسجيل الدخول والموافقة على الأذونات التي يطلبها التطبيق. عند قيام المستخدم بالمصادقة ومنح الموافقة، سيقوم Azure AD بإرسال استجابة إلى التطبيق الخاص بك في عنوان `redirect_uri` الموجود في طلبك.

    ```odata
    // Line breaks for legibility only

    https://login.microsoftonline.com/{tenant}/oauth2/authorize?
    client_id=6731de76-14a6-49ae-97bc-6eba6914391e
    &response_type=code
    &redirect_uri=http%3A%2F%2Flocalhost%3A12345
    &response_mode=query
    &resource=https%3A%2F%2Fservice.contoso.com%2F
    &state=12345
    ```
    نوعا الاستجابات هما:

    -   **الاستجابة الناجحة** - ستمنح الاستجابة الناجحة حق الوصول وتشمل موافقة المسؤول، ورمز التفويض الذي طلبه التطبيق، وقيمة جلسة فريدة، ومعلمة حالة.
    -   **الاستجابة لخطأ** - الاستجابة لخطأ لن تمنح رمز التفويض. تتضمن استجابة الخطأ قيمة رمز الخطأ ووصف الخطأ وقيمة الحالة.

    مع الاستجابة الناجحة، يتم منح رمز التفويض ويتم منح حق الوصول إلى المستخدم.

4. يمكن الآن استرداد الرمز لرمز وصول مميز إلى المورد المطلوب. ويتم تحقيق ذلك عن طريق إرسال طلب POST إلى نقطة نهاية `/token`.
5. عند الاستجابة الناجحة، يقوم Azure AD بإرجاع رمز وصول مميز. الرمز المميز للوصول هو رمز ويب Json المميز (JWT).
6. عند طلب الرمز المميز للوصول، يقوم Azure AD بإرجاع بيانات التعريف حول رمز المميز للوصول لاستهلاك التطبيق. يجب على العميل تخزين رموز الوصول مؤقتاً لمدة الرمز المميز المحدد ضمن استجابة OAuth2. قد ترجع واجهة برمجة التطبيقات (API) الخاصة بالويب استجابة `invalid_token`؛ قد يرجع السبب في ذلك إلى وجود رمز مميز منتهي الصلاحية.
7. عند الحصول على الرمز المميز للوصول، يمكن استخدام الرمز المميز في طلبات واجهات برمجة التطبيقات (API) للويب.
