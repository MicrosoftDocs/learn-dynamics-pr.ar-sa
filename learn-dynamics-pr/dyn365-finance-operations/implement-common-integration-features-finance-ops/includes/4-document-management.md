---
ms.openlocfilehash: bc1dfdf7f24d61591100a4f9e523aa6e28d7fb24
ms.sourcegitcommit: d190aa41f6104061e6ebe52ee5c86b6cb9febaf2
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 05/12/2021
ms.locfileid: "6072642"
---
<span data-ttu-id="fd459-101">تدعم إدارة المستندات حفظ مرفقات السجلات في مخزن Azure Blob وفي SharePoint عبر الإنترنت.</span><span class="sxs-lookup"><span data-stu-id="fd459-101">Document management supports saving record attachments in Azure Blob storage and SharePoint Online.</span></span> <span data-ttu-id="fd459-102">وحده تخزين قاعدة البيانات قديمة.</span><span class="sxs-lookup"><span data-stu-id="fd459-102">Database storage is obsolete.</span></span> <span data-ttu-id="fd459-103">تعادل مساحة تخزين Azure Blob التخزين في قاعدة البيانات لأنه لا يمكن الوصول إلى المستندات إلا من خلال التطبيق، كما أنها توفر فائدة إضافية تتمثل في توفير مساحة تخزين لا تؤثر سلباً على أداء قاعدة البيانات.</span><span class="sxs-lookup"><span data-stu-id="fd459-103">Azure Blob storage is equivalent to storage in the database because documents can only be accessed through the application, and it offers the added benefit of providing storage that doesn't negatively affect the performance of the database.</span></span> 

![لقطة شاشة لخصائص إدارة المستندات.](../media/doc-manage.png)

<span data-ttu-id="fd459-105">التخزين الخاص بـ Azure Blob هو الافتراضي ويعمل على الفور.</span><span class="sxs-lookup"><span data-stu-id="fd459-105">Azure blob storage is the default and works immediately.</span></span> <span data-ttu-id="fd459-106">سيعمل تخزين SharePoint فوراً إذا كان لديك رخصة Microsoft 365 لأنه يقوم تلقائياً بالتعامل مع مستأجر SharePoint، كمستخدم على TenantA.onmicrosoft.com.</span><span class="sxs-lookup"><span data-stu-id="fd459-106">SharePoint storage will work immediately if you have a Microsoft 365 license because it auto-discovers the SharePoint tenant, such as a user on the TenantA.onmicrosoft.com.</span></span> <span data-ttu-id="fd459-107">يحصل مستأجر Microsoft 365/Azure AD على TenantA.sharepoint.com مثل موقع SharePoint.</span><span class="sxs-lookup"><span data-stu-id="fd459-107">Microsoft 365/Azure AD tenant gets TenantA.sharepoint.com as the SharePoint site.</span></span> <span data-ttu-id="fd459-108">إذا تم إيقاف تشغيل إدارة المستندات بواسطة المستخدم، فقمّ بتشغيلها بتحديد **عام > الإعداد > خيارات المستخدم > التفضيلات > متنوعات** وإعداد **معالجة المستندات نشطة** إلى **نعم**.</span><span class="sxs-lookup"><span data-stu-id="fd459-108">If document management has been turned off by the user, turn it on by selecting **Common > Setup > User options > Preferences > Miscellaneous** and setting **Document handling active** to **Yes**.</span></span> 

<span data-ttu-id="fd459-109">في أي صفحة تحتوي على بيانات، سيكون زر **إرفاق** متاحاً في الزاوية العلوية اليمنى.</span><span class="sxs-lookup"><span data-stu-id="fd459-109">On any page that has data, an **Attach** button will be available in the upper-right corner.</span></span> <span data-ttu-id="fd459-110">توفر صفة **المرفقات** طريقة عرض للمرفقات (المستندات) المرتبطة بالسجل الذي تم تحديده في الصفحة السابقة.</span><span class="sxs-lookup"><span data-stu-id="fd459-110">The **Attachments** page provides a view of the attachments (documents) that are associated with the record that was selected on the previous page.</span></span> <span data-ttu-id="fd459-111">يمكنك إضافة مرفقات جديدة إلى السجل عن طريق تحديد زر **جديد** (**+**) في شريط التطبيق.</span><span class="sxs-lookup"><span data-stu-id="fd459-111">You can add new attachments to the record by selecting the **New** button (**+**) in the app bar.</span></span> <span data-ttu-id="fd459-112">بالنسبة لأنواع مستندات **الملفات** و **الصور**، ستتم مطالبتك بتوفير الملف المقترن.</span><span class="sxs-lookup"><span data-stu-id="fd459-112">For the **File** and **Image** document types, you will be prompted to provide the associated file.</span></span>

<span data-ttu-id="fd459-113">يتم توفير معاينة لأنواع الملفات المعتمدة في علامة التبويب السريعة **معاينة**.</span><span class="sxs-lookup"><span data-stu-id="fd459-113">A preview for supported file types is provided on the **Preview** FastTab.</span></span> <span data-ttu-id="fd459-114">يتم دعم أنواع المستندات الأساسية، مثل صور PNG والملفات النصية، بشكل افتراضي.</span><span class="sxs-lookup"><span data-stu-id="fd459-114">Basic document types, such as PNG images and text files, are supported by default.</span></span> <span data-ttu-id="fd459-115">يجب أن تستخدم أنواع مستندات Office، مثل ملفات Microsoft Word، وExcel وPowerPoint، خادم Office Web Apps، والذي قد لا يكون متوفراً في تكوين OneBox.</span><span class="sxs-lookup"><span data-stu-id="fd459-115">Office document types, such as Microsoft Word, Excel, and PowerPoint files, must use a production Office Web Apps Server, which might not be available in a OneBox configuration.</span></span>

<span data-ttu-id="fd459-116">تحتوي تجارب **فتح في Excel** المنشأة تلقائياً التي تم إنشاؤها للكيانات على ربط جدول واحد.</span><span class="sxs-lookup"><span data-stu-id="fd459-116">The automatically generated **Open in Excel** experiences that are created for entities have a single table binding.</span></span>

<span data-ttu-id="fd459-117">يمكن للمطور في فريقك المساعدة في تحقيق ما يلي باستخدام Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="fd459-117">A developer in your team can help you achieve the following by using Visual Studio.</span></span>

- <span data-ttu-id="fd459-118">يمكنك إيقاف آلية التصدير إلى Excel الثابتة لشبكة أو تغيير التسمية التي تظهر في قائمة **فتح في Microsoft Office**.</span><span class="sxs-lookup"><span data-stu-id="fd459-118">You can suppress the static Export to Excel mechanism for a grid or change the label that appears on the **Open in Microsoft Office** menu.</span></span> 
- <span data-ttu-id="fd459-119">يتم تحديد قائمة الحقول التي تمت إضافتها إلى ربط الجدول هذا بواسطة مجموعة الحقول **تقرير تلقائي** في حالة احتواء ربط الجدول على حقول.</span><span class="sxs-lookup"><span data-stu-id="fd459-119">The list of fields that are added to that table binding is defined by the **AutoReport** field group if the table binding contains fields.</span></span> <span data-ttu-id="fd459-120">وبخلاف ذلك، تتم إضافة الحقول الأساسية والإلزامية للكيان تلقائياً.</span><span class="sxs-lookup"><span data-stu-id="fd459-120">Otherwise, the key and mandatory fields for the entity are automatically added.</span></span> <span data-ttu-id="fd459-121">يحدد ترتيب الحقول في مجموعة **تقرير تلقائي** ترتيب الحقول في ربط الجدول.</span><span class="sxs-lookup"><span data-stu-id="fd459-121">The order of fields in the **AutoReport** group determines the order of fields in the table binding.</span></span>
- <span data-ttu-id="fd459-122">يتم تحميل القوالب المسجلة كقوالب معرفة من قبل النظام عند التوزيع.</span><span class="sxs-lookup"><span data-stu-id="fd459-122">Templates that are registered as system-defined templates are loaded at deployment.</span></span> <span data-ttu-id="fd459-123">يعتبر هذا السلوك مفيداً لموردي البرامج المستقلين (ISV) والشركاء الذين يرغبون في حزم القوالب مع عناصر نموذجية أخرى.</span><span class="sxs-lookup"><span data-stu-id="fd459-123">This behavior is useful for independent software vendors (ISVs) and partners that want to package templates together with other model artifacts.</span></span>

### <a name="preview-documents"></a><span data-ttu-id="fd459-124">معاينة المستندات</span><span class="sxs-lookup"><span data-stu-id="fd459-124">Preview documents</span></span>

<span data-ttu-id="fd459-125">يمكنك تحديد وجهات إجراءات إدارة الطباعة المختلفة لمستندات الأعمال القابلة للتكوين.</span><span class="sxs-lookup"><span data-stu-id="fd459-125">You can specify the destinations for various print management actions for configurable business documents.</span></span> <span data-ttu-id="fd459-126">وهذا يعني أنه للمعاينة، يمكن استخدام السيناريو **معاينة/طباعة > أصلي**، وللبريد الإلكتروني والطباعة، يمكن استخدام **معاينة /طباعة > استخدام إدارة الطباعة**.</span><span class="sxs-lookup"><span data-stu-id="fd459-126">This means that for a preview, the scenario **Preview/Print > Original** can be used, and for email and printing, **Preview/Print > Use print management** can be used.</span></span>


## <a name="templates"></a><span data-ttu-id="fd459-127">القوالب</span><span class="sxs-lookup"><span data-stu-id="fd459-127">Templates</span></span>
<span data-ttu-id="fd459-128">عند تعيين قالب مدرج في صفحة **عام > عام > دمج Office > قوالب المستندات** (DocuTemplate) تحتوي على **ShowInOpenInOfficeMenu** إلى **نعم** وكان له نفس مصدر البيانات الجذر (الجدول) مثل الصفحة الحالية، ستتم إضافته كخيار في قسم **فتح في Excel** من قائمة **فتح في Microsoft Office**.</span><span class="sxs-lookup"><span data-stu-id="fd459-128">When a template listed in the **Common > Common > Office integration > Document templates** page (DocuTemplate) has **ShowInOpenInOfficeMenu** set to **Yes** and has the same root datasource (table) as the current page, it will be added as an option in the **Open in Excel** section of the **Open in Microsoft Office** menu.</span></span> 

<span data-ttu-id="fd459-129">القالب عبارة عن مصطنع يجب الاحتفاظ به وإصداره.</span><span class="sxs-lookup"><span data-stu-id="fd459-129">A template is an artifact that needs to be maintained and versioned.</span></span>  

<span data-ttu-id="fd459-130">أنشئ قالباً إذا:</span><span class="sxs-lookup"><span data-stu-id="fd459-130">Create a template if:</span></span>
- <span data-ttu-id="fd459-131">أنت بحاجة إلى محتوى إضافي أو تنسيق في القالب.</span><span class="sxs-lookup"><span data-stu-id="fd459-131">You need additional content or formatting in the template.</span></span>
- <span data-ttu-id="fd459-132">تريد دمج كيانات متعددة أو مصادر بيانات في نفس المصنف.</span><span class="sxs-lookup"><span data-stu-id="fd459-132">You want to combine multiple entities or data sources in the same workbook.</span></span>


<span data-ttu-id="fd459-133">عند إنشاء قالب لكيان يحتوي على حقول خاصة ببلد أو منطقة، يجب ترك هذه الحقول الخاصة بالمنطقة خارج القالب.</span><span class="sxs-lookup"><span data-stu-id="fd459-133">When creating a template for an entity that has country or region-specific fields, you should leave those region-specific fields out of the template.</span></span> <span data-ttu-id="fd459-134">خلاف ذلك، سيرى جميع المستخدمين الحقول الخاصة بالبلد أو المنطقة.</span><span class="sxs-lookup"><span data-stu-id="fd459-134">Otherwise, all users will see the country or region-specific fields.</span></span> 

<span data-ttu-id="fd459-135">يجب أن تلبي القوالب احتياجات معظم المستخدمين بشكل افتراضي ويمكن للمستخدمين الخاصين بالمنطقة إضافة هذه الحقول باستخدام تجربة تصميم سهلة الاستخدام لوظيفة Excel الإضافية.</span><span class="sxs-lookup"><span data-stu-id="fd459-135">Templates should cater to most users by default and region-specific users can add those fields by using the easy-to-use design experience of the Excel add-in.</span></span> <span data-ttu-id="fd459-136">يمكن إضافة الحقول والأعمدة الخاصة بالمنطقة بواسطة المستخدمين حسب الحاجة.</span><span class="sxs-lookup"><span data-stu-id="fd459-136">The region-specific fields and columns can be added by users as needed.</span></span> <span data-ttu-id="fd459-137">يمكن حفظ هذا القالب إلى الكمبيوتر المحلي لإعادة استخدامه بواسطة مستخدم واحد أو تحميله عبر صفحة **قوالب المستندات** لإعادة استخدامه بواسطة أي مستخدم لهذا المثيل.</span><span class="sxs-lookup"><span data-stu-id="fd459-137">That template can be either saved to local computer for reuse by a single user or uploaded via the **Document Templates** page for reuse by any user of that instance.</span></span> <span data-ttu-id="fd459-138">وهناك اعتباران آخران:</span><span class="sxs-lookup"><span data-stu-id="fd459-138">A couple of other considerations:</span></span>

- <span data-ttu-id="fd459-139">إذا كانت المنطقة بها كيان خاص ببلد أو منطقة معينة، فيمكن عندئذٍ إنشاء قالب خاص بالبلد أو المنطقة.</span><span class="sxs-lookup"><span data-stu-id="fd459-139">If a region has a country or region-specific entity, then a country or region-specific template could be created.</span></span>
- <span data-ttu-id="fd459-140">إذا كانت المنطقة مهمة بدرجة كافية، فيمكنك تحديد قالب خاص بالبلد أو المنطقة وقالب عام لبلد أو منطقة.</span><span class="sxs-lookup"><span data-stu-id="fd459-140">If a region is important enough, then you could define a country or region-specific template and a country or region-generic template.</span></span>

## <a name="scan-file-attachments-for-malicious-threats"></a><span data-ttu-id="fd459-141">فحص مرفقات الملفات بحثاً عن التهديدات الضارة</span><span class="sxs-lookup"><span data-stu-id="fd459-141">Scan file attachments for malicious threats</span></span>
<span data-ttu-id="fd459-142">عند العمل مع مرفقات الملفات، قد ترغب مؤسستك في فحص الملفات بحثاً عن أي تهديدات ضارة قبل تحميل المستند إلى Dynamics 365.</span><span class="sxs-lookup"><span data-stu-id="fd459-142">When working with file attachments, your organization may want files to be scanned for any malicious threats before the document is uploaded to Dynamics 365.</span></span> <span data-ttu-id="fd459-143">توجد نقطة امتداد في التطبيق تُتيح لك دمج برنامج مسح الملفات الذي تختاره في عملية تحميل الملف.</span><span class="sxs-lookup"><span data-stu-id="fd459-143">There is an extension point in the application that lets you integrate file scanning software of your choice into the file upload process.</span></span> <span data-ttu-id="fd459-144">توجد أيضاً نقاط ملحق مماثلة متاحة لمسح المرفقات.</span><span class="sxs-lookup"><span data-stu-id="fd459-144">There are also similar extension points that are available for scanning attachments.</span></span> 

<span data-ttu-id="fd459-145">تعرض فئة **FileUploadResultBase** تفويض **delegateScanStream()**.</span><span class="sxs-lookup"><span data-stu-id="fd459-145">The **FileUploadResultBase** class exposes the **delegateScanStream()** delegate.</span></span> <span data-ttu-id="fd459-146">يتم تطبيق التفويض على أي تحميل ملف يتم فيه تخصيص فئة **استراتيجية التحميل**.</span><span class="sxs-lookup"><span data-stu-id="fd459-146">The delegate applies to any file upload where the **Upload strategy** class has been specialized.</span></span> <span data-ttu-id="fd459-147">إذا حدد برنامج المسح أن التحميل ضار، فستفشل عملية التحميل.</span><span class="sxs-lookup"><span data-stu-id="fd459-147">If the scanning software determines that the upload is malicious, the upload process will fail.</span></span> 


